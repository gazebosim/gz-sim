load(
    "//ign_bazel:cmake_configure_file.bzl",
    "cmake_configure_file",
)

BINARY_DIR = "./ign_gazebo"
SOURCE_DIR = "./ign_gazebo"
IGNITION_TOOLS_BINARY_DIRS = "/tmp"
PROJECT_NAME = "ignition-gazebo"
PROJECT_MAJOR = 4
PROJECT_MINOR = 0
PROJECT_PATCH = 0

# Generates config.hh based on the version numbers in CMake code.
cmake_configure_file(
    name = "test_config",
    src = "test_config.hh.in",
    out = "ignition/gazebo/test_config.hh",
    cmakelists = ["CMakeLists.txt"],
    defines = [
        "PROJECT_BINARY_DIR=%s" % (BINARY_DIR),
        "PROJECT_SOURCE_DIR=%s" % (SOURCE_DIR),
        "CMAKE_BINARY_DIR=%s" % (BINARY_DIR),
        "IGNITION-TOOLS_BINARY_DIRS=%s" % (IGNITION_TOOLS_BINARY_DIRS),
        "PROJECT_VERSION_FULL=%d.%d.%d" % (PROJECT_MAJOR, PROJECT_MINOR, PROJECT_PATCH),  # noqa
    ],
    visibility = ["//visibility:private"],
)

cc_binary(
    name = "libTestSystem.so",
    srcs = ["plugins/TestSystem.cc", "plugins/TestSystem.hh"],
    linkshared = True,
    includes = ["."],
    visibility = ["//visibility:public"],
    deps = [
        "//ign_common",
        "//ign_common/events",
        "//ign_gazebo",
        "//ign_msgs",
        "//ign_plugin/register",
        "//sdformat",
    ]
)

cc_binary(
    name = "libTestSensorSystem.so",
    srcs = ["plugins/TestSensorSystem.cc", "plugins/TestSensorSystem.hh"],
    linkshared = True,
    includes = ["."],
    visibility = ["//visibility:public"],
    deps = [
        "//ign_common",
        "//ign_common/events",
        "//ign_gazebo",
        "//ign_msgs",
        "//ign_plugin/register",
        "//sdformat",
        "//ign_transport",
    ]
)

cc_binary(
    name = "libTestWorldSystem.so",
    srcs = ["plugins/TestWorldSystem.cc", "plugins/TestWorldSystem.hh"],
    linkshared = True,
    includes = ["."],
    visibility = ["//visibility:public"],
    deps = [
        "//ign_common",
        "//ign_common/events",
        "//ign_gazebo",
        "//ign_msgs",
        "//ign_plugin/register",
        "//sdformat",
    ]
)

cc_binary(
    name = "libTestModelSystem.so",
    srcs = ["plugins/TestModelSystem.cc", "plugins/TestModelSystem.hh"],
    linkshared = True,
    includes = ["."],
    visibility = ["//visibility:public"],
    deps = [
        "//ign_common",
        "//ign_common/events",
        "//ign_gazebo",
        "//ign_transport",
        "//ign_msgs",
        "//ign_plugin/register",
        "//sdformat",
    ]
)

cc_library(
    name = "test_systems",
    deps = [ 
        ":libTestSystem.so", 
        ":libTestWorldSystem.so", 
        ":libTestModelSystem.so",
        ":libTestSensorSystem.so"
    ],
    visibility = ["//visibility:public"],
    data = glob(["worlds/*.sdf"]),
)

cc_library(
    name = "test_utils",
    srcs = ["ignition/gazebo/test_config.hh"],
    includes = ["."],
    visibility = ["//visibility:public"],
    data = glob(["worlds/*.sdf"]),
)


